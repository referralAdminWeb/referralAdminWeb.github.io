(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[798],{46809:function(V,U,t){"use strict";t.r(U),t.d(U,{default:function(){return $e}});var X=t(19632),q=t.n(X),T=t(15009),f=t.n(T),L=t(99289),B=t.n(L),J=t(9783),K=t.n(J),Q=t(97857),E=t.n(Q),A=t(5574),i=t.n(A),Se=t(13769),se=t.n(Se),z=t(92861),b=t(29933),_=t(94272),ee=t(53025),ie=t(26915),le=t(2453),te=t(78957),ue=t(83622),de=t(4393),G=t(55054),Ie=t(74330),k=t(78045),ae=t(96068),De=t(85265),Ze=t(9220),n=t(67294),Fe=t(64599),Ce=t.n(Fe),Te=t(80652),Ee=t(27484),re=t.n(Ee),e=t(85893),Pe=function(o){var m=o.type,l=o.value,S=(0,n.useState)(!1),u=i()(S,2),g=u[0],p=u[1],I=(0,_.useIntl)(),D=(0,n.useState)([]),C=i()(D,2),j=C[0],Z=C[1],M=function(){var v=B()(f()().mark(function c(){var h,x,a,N,P,$;return f()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.prev=0,p(!0),y.next=4,z.Z.promotionTrack.getListByDay(30,m,l);case 4:if(h=y.sent,h){x=[],a=Ce()(h);try{for(a.s();!(N=a.n()).done;)P=N.value,$=re()(P.date).format("YYYY-MM-DD"),x.push({date:$,type:I.formatMessage({id:"pages.promotionTrack.view"}),count:P.view}),x.push({date:$,type:I.formatMessage({id:"pages.promotionTrack.download"}),count:P.download}),x.push({date:$,type:I.formatMessage({id:"pages.promotionTrack.register"}),count:P.register})}catch(O){a.e(O)}finally{a.f()}x=x.reverse(),Z(x)}p(!1),y.next=14;break;case 9:return y.prev=9,y.t0=y.catch(0),p(!1),console.error(y.t0),y.abrupt("return",!1);case 14:case"end":return y.stop()}},c,null,[[0,9]])}));return function(){return v.apply(this,arguments)}}();return(0,n.useEffect)(function(){M()},[m,l]),(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(Te.Z,{data:j,xField:"date",yField:"count",colorField:"type",axis:{y:{labelFormatter:function(c){return c.toLocaleString()}}},shapeField:"smooth",scale:{y:{domainMin:0}},tooltip:{channel:"y",valueFormatter:function(c){return c.toLocaleString()}}})})},Le=Pe,Be=function(o){var m=o.type,l=o.value,S=(0,n.useState)(!1),u=i()(S,2),g=u[0],p=u[1],I=(0,n.useState)([]),D=i()(I,2),C=D[0],j=D[1],Z=[{title:"date",dataIndex:"date",render:function(c,h,x){return re()(c).format("YYYY-MM-DD")}},{title:"\u8BBF\u95EE\u6B21\u6570",dataIndex:"view"},{title:"\u4E0B\u8F7D\u6B21\u6570",dataIndex:"download"},{title:"\u6CE8\u518C\u6B21\u6570",dataIndex:"register"},{title:"\u72EC\u7ACBIP\u6570",dataIndex:"ip"},{title:"\u72EC\u7ACB\u8BBE\u5907\u6570",dataIndex:"deviceId"}],M=function(){var v=B()(f()().mark(function c(){var h;return f()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,p(!0),a.next=4,z.Z.promotionTrack.getListByLimit(90,m,l);case 4:h=a.sent,h&&j(h),p(!1),a.next=14;break;case 9:return a.prev=9,a.t0=a.catch(0),p(!1),console.error(a.t0),a.abrupt("return",!1);case 14:case"end":return a.stop()}},c,null,[[0,9]])}));return function(){return v.apply(this,arguments)}}();return(0,n.useEffect)(function(){M()},[m,l]),(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(ae.Z,{size:"small",columns:Z,dataSource:C,pagination:!1})})},Me=Be,we=function(o){var m=o.type,l=o.value,S=(0,n.useState)(!1),u=i()(S,2),g=u[0],p=u[1],I=(0,n.useState)([]),D=i()(I,2),C=D[0],j=D[1],Z=[{title:"\u65F6\u95F4",dataIndex:"eventTime",render:function(c,h,x){return re().unix(c).format("YYYY-MM-DD")},minWidth:120},{title:"Category",dataIndex:"category"},{title:"utm_source",dataIndex:"utmSource"},{title:"eid",dataIndex:"eid"},{title:"pid",dataIndex:"pid"},{title:"code",dataIndex:"code"},{title:"user_agent",dataIndex:"user_agent"},{title:"browser",dataIndex:"browser"},{title:"deviceId",dataIndex:"deviceId"},{title:"device",dataIndex:"device"},{title:"ip",dataIndex:"ip"},{title:"platform",dataIndex:"platform"},{title:"geo",dataIndex:"geo"},{title:"lang",dataIndex:"lang"},{title:"countryCode",dataIndex:"countryCode"},{title:"referer",dataIndex:"referer"},{title:"extra",dataIndex:"extra"}],M=function(){var v=B()(f()().mark(function c(){var h;return f()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,p(!0),a.next=4,z.Z.promotionTrack.getLogListByLimit(100,m,l);case 4:h=a.sent,h&&j(h),p(!1),a.next=14;break;case 9:return a.prev=9,a.t0=a.catch(0),p(!1),console.error(a.t0),a.abrupt("return",!1);case 14:case"end":return a.stop()}},c,null,[[0,9]])}));return function(){return v.apply(this,arguments)}}();return(0,n.useEffect)(function(){M()},[m,l]),(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(ae.Z,{size:"small",scroll:{x:!0},columns:Z,dataSource:C,pagination:!1})})},be=we,oe=b.Z.Divider,Re=function(o){var m=o.type,l=o.value,S=(0,n.useState)(void 0),u=i()(S,2),g=u[0],p=u[1],I=(0,_.useIntl)(),D=function(){var C=B()(f()().mark(function j(){var Z;return f()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,z.Z.promotionTrack.getAccumulatedData(m,l);case 2:Z=v.sent,p(Z.data);case 4:case"end":return v.stop()}},j)}));return function(){return C.apply(this,arguments)}}();return(0,n.useEffect)(function(){D()},[]),(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"h1",children:"".concat(I.formatMessage({id:"pages.promotionTrack.utm_source"}),": ").concat(l)}),(0,e.jsx)("div",{children:(0,e.jsxs)(b.Z.Group,{direction:"row",children:[(0,e.jsx)(b.Z,{children:(0,e.jsx)(G.Z,{title:"\u7D2F\u8BA1\u8BBF\u95EE",value:g?g.view:"-"})}),(0,e.jsx)(oe,{type:"vertical"}),(0,e.jsx)(b.Z,{children:(0,e.jsx)(G.Z,{title:"\u7D2F\u8BA1\u4E0B\u8F7D",value:g?g.download:"-"})}),(0,e.jsx)(oe,{type:"vertical"}),(0,e.jsx)(b.Z,{children:(0,e.jsx)(G.Z,{title:"\u7D2F\u8BA1\u6CE8\u518C",value:g?g.register:"-"})})]})}),(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"h3",children:"30\u5929\u63A8\u5E7F\u66F2\u7EBF"}),(0,e.jsx)(Le,{type:m,value:l})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"h3",children:"\u8BBF\u95EE\u7EDF\u8BA1\u6570\u636E \uFF08\u6CE8\u610F\uFF0C\u53D6\u6700\u8FD190\u6761\uFF09"}),(0,e.jsx)(Me,{type:m,value:l})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"h3",children:"\u8BBF\u95EE\u65E5\u5FD7 \uFF08\u6CE8\uFF0C\u53D6\u6700\u8FD1100\u6761\uFF09"}),(0,e.jsx)(be,{type:m,value:l})]})]})},ke=Re,He=["index"],Ae=["title","editable","children","dataIndex","record","handleSave"],ce=n.createContext(null),Ne=function(o){var m=o.index,l=se()(o,He),S=ee.Z.useForm(),u=i()(S,1),g=u[0];return(0,e.jsx)(ee.Z,{form:g,component:!1,children:(0,e.jsx)(ce.Provider,{value:g,children:(0,e.jsx)("tr",E()({},l))})})},Ye=function(o){var m=o.title,l=o.editable,S=o.children,u=o.dataIndex,g=o.record,p=o.handleSave,I=se()(o,Ae),D=(0,n.useState)(!1),C=i()(D,2),j=C[0],Z=C[1],M=(0,n.useRef)(null),v=(0,n.useContext)(ce);(0,n.useEffect)(function(){if(j){var a;(a=M.current)===null||a===void 0||a.focus()}},[j]);var c=function(){Z(!j),v.setFieldsValue(K()({},u,g[u]))},h=function(){var a=B()(f()().mark(function N(){var P;return f()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.prev=0,F.next=3,v.validateFields();case 3:P=F.sent,c(),p(E()(E()({},g),P)),F.next=11;break;case 8:F.prev=8,F.t0=F.catch(0),console.log("Save failed:",F.t0);case 11:case"end":return F.stop()}},N,null,[[0,8]])}));return function(){return a.apply(this,arguments)}}(),x=S;return l&&(x=j?(0,e.jsx)(ee.Z.Item,{style:{margin:0},name:u,children:(0,e.jsx)(ie.Z,{ref:M,onPressEnter:h,onBlur:h})}):(0,e.jsx)("div",{className:"editable-cell-value-wrap",style:{paddingInlineEnd:24},onClick:c,children:S})),(0,e.jsx)("td",E()(E()({},I),{},{children:x}))},ve=b.Z.Divider,ze=function(){var o=(0,n.useState)(void 0),m=i()(o,2),l=m[0],S=m[1],u=(0,_.useIntl)(),g=(0,n.useState)([]),p=i()(g,2),I=p[0],D=p[1],C=(0,n.useState)(!1),j=i()(C,2),Z=j[0],M=j[1],v=(0,n.useState)(!1),c=i()(v,2),h=c[0],x=c[1],a=(0,n.useState)("24H"),N=i()(a,2),P=N[0],$=N[1],F=(0,n.useState)("utm_source"),y=i()(F,2),O=y[0],Ge=y[1],We=(0,n.useState)(""),fe=i()(We,2),me=fe[0],pe=fe[1],Oe=(0,n.useState)(!1),he=i()(Oe,2),Ve=he[0],ge=he[1],Je=(0,n.useState)(void 0),xe=i()(Je,2),ne=xe[0],je=xe[1],Ke={body:{row:Ne,cell:Ye}},Qe=function(){var d=B()(f()().mark(function r(s){var w,R,Y;return f()().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return H.prev=0,H.next=3,z.Z.promotionTrack.editRemark(s.typ,s.value,s.remark);case 3:le.ZP.success(u.formatMessage({id:"pages.vipList.update.success"})),w=q()(I),R=w.findIndex(function(et){return s.value===et.value}),Y=w[R],w.splice(R,1,E()(E()({},Y),s)),D(w),H.next=14;break;case 11:H.prev=11,H.t0=H.catch(0),le.ZP.success(u.formatMessage({id:"pages.vipList.update.error"}));case 14:case"end":return H.stop()}},r,null,[[0,11]])}));return function(s){return d.apply(this,arguments)}}(),Ue=function(r){Qe(r)},Xe=[{title:"ID",dataIndex:"value",render:function(r,s){return(0,e.jsx)(te.Z,{size:"middle",children:(0,e.jsx)(ue.ZP,{type:"link",onClick:function(){je({type:O,value:s.value}),ge(!0)},children:s.value})})}},{title:"\u8BBF\u95EE\u6B21\u6570",dataIndex:"view",sorter:function(r,s){return r.view-s.view}},{title:"\u4E0B\u8F7D\u6B21\u6570",dataIndex:"download",sorter:function(r,s){return r.download-s.download}},{title:"\u6CE8\u518C\u6B21\u6570",dataIndex:"register",sorter:function(r,s){return r.register-s.register}},{title:"\u72EC\u7ACBIP\u6570",dataIndex:"ip",sorter:function(r,s){return r.ip-s.ip}},{title:"\u72EC\u7ACB\u8BBE\u5907\u6570",dataIndex:"deviceId",sorter:function(r,s){return r.deviceId-s.deviceId}},{title:"\u5907\u6CE8\u4FE1\u606F",dataIndex:"remark",editable:!0,minWidth:100}],qe=Xe.map(function(d){return d.editable?E()(E()({},d),{},{onCell:function(s){return{record:s,editable:d.editable,dataIndex:d.dataIndex,title:d.title,handleSave:Ue}}}):d}),_e=function(){var d=B()(f()().mark(function r(){var s;return f()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.next=2,z.Z.promotionTrack.get24HData();case 2:s=R.sent,S(s.data);case 4:case"end":return R.stop()}},r)}));return function(){return d.apply(this,arguments)}}(),ye=function(){var d=B()(f()().mark(function r(s){var w;return f()().wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:return x(!0),Y.next=3,z.Z.promotionTrack.getStatisticalList(P,O,s);case 3:w=Y.sent,w.data&&D(w.data),x(!1);case 6:case"end":return Y.stop()}},r)}));return function(s){return d.apply(this,arguments)}}();return(0,n.useEffect)(function(){_e()},[]),(0,n.useEffect)(function(){pe(""),ye("")},[O,P]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(de.Z,{children:(0,e.jsx)(Ze.Z,{onResize:function(r){M(r.width<596)},children:(0,e.jsxs)(b.Z.Group,{direction:Z?"column":"row",children:[(0,e.jsx)(b.Z,{children:(0,e.jsx)(G.Z,{title:"24H\u603B\u8BBF\u95EE",value:l?l.view:"-"})}),(0,e.jsx)(ve,{type:Z?"horizontal":"vertical"}),(0,e.jsx)(b.Z,{children:(0,e.jsx)(G.Z,{title:"24H\u603B\u4E0B\u8F7D",value:l?l.download:"-"})}),(0,e.jsx)(ve,{type:Z?"horizontal":"vertical"}),(0,e.jsx)(b.Z,{children:(0,e.jsx)(G.Z,{title:"24H\u6CE8\u518C\u6570",value:l?l.register:"-"})})]})},"resize-observer")}),(0,e.jsx)(de.Z,{children:(0,e.jsxs)(Ie.Z,{spinning:h,tip:u.formatMessage({id:"loading"}),children:[(0,e.jsxs)("div",{className:"tools",children:[(0,e.jsxs)("div",{className:"search",children:[(0,e.jsx)("div",{className:"item",children:(0,e.jsx)(te.Z,{children:(0,e.jsxs)(k.ZP.Group,{value:O,onChange:function(r){return Ge(r.target.value)},children:[(0,e.jsx)(k.ZP.Button,{value:"utm_source",children:u.formatMessage({id:"pages.promotionTrack.utm_source"})}),(0,e.jsx)(k.ZP.Button,{value:"eid",children:u.formatMessage({id:"pages.promotionTrack.eid"})}),(0,e.jsx)(k.ZP.Button,{value:"pid",children:u.formatMessage({id:"pages.promotionTrack.pid"})}),(0,e.jsx)(k.ZP.Button,{value:"code",children:u.formatMessage({id:"pages.promotionTrack.code"})})]})})}),(0,e.jsx)("div",{className:"item",children:(0,e.jsx)(ie.Z,{value:me,onChange:function(r){return pe(r.target.value)}})}),(0,e.jsx)("div",{className:"item",children:(0,e.jsx)(ue.ZP,{onClick:function(){return ye(me)},children:"\u641C\u7D22"})})]}),(0,e.jsx)("div",{className:"filter",children:(0,e.jsx)(te.Z,{children:(0,e.jsxs)(k.ZP.Group,{value:P,onChange:function(r){return $(r.target.value)},children:[(0,e.jsx)(k.ZP.Button,{value:"24H",children:"24H"}),(0,e.jsx)(k.ZP.Button,{value:"7D",children:"7D"}),(0,e.jsx)(k.ZP.Button,{value:"1M",children:"1M"})]})})})]}),(0,e.jsx)("div",{children:(0,e.jsx)(ae.Z,{components:Ke,rowClassName:"editable-row",columns:qe,dataSource:I,pagination:!1})}),(0,e.jsx)(De.Z,{width:600,open:Ve,onClose:function(){je(void 0),ge(!1)},closable:!1,children:ne&&(0,e.jsx)(ke,{type:ne.type,value:ne.value})})]})})]})},$e=ze},64599:function(V,U,t){var X=t(96263);function q(T,f){var L=typeof Symbol!="undefined"&&T[Symbol.iterator]||T["@@iterator"];if(!L){if(Array.isArray(T)||(L=X(T))||f&&T&&typeof T.length=="number"){L&&(T=L);var B=0,J=function(){};return{s:J,n:function(){return B>=T.length?{done:!0}:{done:!1,value:T[B++]}},e:function(i){throw i},f:J}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var K=!0,Q=!1,E;return{s:function(){L=L.call(T)},n:function(){var i=L.next();return K=i.done,i},e:function(i){Q=!0,E=i},f:function(){try{!K&&L.return!=null&&L.return()}finally{if(Q)throw E}}}}V.exports=q,V.exports.__esModule=!0,V.exports.default=V.exports}}]);
