"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[362],{5966:function(pe,Q,t){var X=t(97685),o=t(1413),q=t(91),h=t(21770),se=t(116),L=t(55241),Z=t(98423),te=t(67294),U=t(22360),P=t(85893),_=["fieldProps","proFieldProps"],T=["fieldProps","proFieldProps"],y="text",ee=function(c){var u=c.fieldProps,j=c.proFieldProps,S=(0,q.Z)(c,_);return(0,P.jsx)(U.Z,(0,o.Z)({valueType:y,fieldProps:u,filedConfig:{valueType:y},proFieldProps:j},S))},M=function(c){var u=(0,h.Z)(c.open||!1,{value:c.open,onChange:c.onOpenChange}),j=(0,X.Z)(u,2),S=j[0],z=j[1];return(0,P.jsx)(se.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function(E){var R,F=E.getFieldValue(c.name||[]);return(0,P.jsx)(L.Z,(0,o.Z)((0,o.Z)({getPopupContainer:function(v){return v&&v.parentNode?v.parentNode:v},onOpenChange:function(v){return z(v)},content:(0,P.jsxs)("div",{style:{padding:"4px 0"},children:[(R=c.statusRender)===null||R===void 0?void 0:R.call(c,F),c.strengthText?(0,P.jsx)("div",{style:{marginTop:10},children:(0,P.jsx)("span",{children:c.strengthText})}):null]}),overlayStyle:{width:240},placement:"rightTop"},c.popoverProps),{},{open:S,children:c.children}))}})},re=function(c){var u=c.fieldProps,j=c.proFieldProps,S=(0,q.Z)(c,T),z=(0,te.useState)(!1),k=(0,X.Z)(z,2),E=k[0],R=k[1];return u!=null&&u.statusRender&&S.name?(0,P.jsx)(M,{name:S.name,statusRender:u==null?void 0:u.statusRender,popoverProps:u==null?void 0:u.popoverProps,strengthText:u==null?void 0:u.strengthText,open:E,onOpenChange:R,children:(0,P.jsx)("div",{children:(0,P.jsx)(U.Z,(0,o.Z)({valueType:"password",fieldProps:(0,o.Z)((0,o.Z)({},(0,Z.Z)(u,["statusRender","popoverProps","strengthText"])),{},{onBlur:function(w){var v;u==null||(v=u.onBlur)===null||v===void 0||v.call(u,w),R(!1)},onClick:function(w){var v;u==null||(v=u.onClick)===null||v===void 0||v.call(u,w),R(!0)}}),proFieldProps:j,filedConfig:{valueType:y}},S))})}):(0,P.jsx)(U.Z,(0,o.Z)({valueType:"password",fieldProps:u,proFieldProps:j,filedConfig:{valueType:y}},S))},I=ee;I.Password=re,I.displayName="ProFormComponent",Q.Z=I},72583:function(pe,Q,t){t.r(Q),t.d(Q,{default:function(){return ge}});var X=t(15009),o=t.n(X),q=t(99289),h=t.n(q),se=t(5574),L=t.n(se),Z=t(75456),te=t(51042),U=t(90930),P=t(21657),_=t(37476),T=t(1413),y=t(91),ee=t(22270),M=t(67294),re=t(66758),I=t(22360),l=t(85893),c=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],u=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],j=function(g,b){var H=g.fieldProps,N=g.children,V=g.params,D=g.proFieldProps,G=g.mode,x=g.valueEnum,J=g.request,W=g.showSearch,B=g.options,Y=(0,y.Z)(g,c),ie=(0,M.useContext)(re.Z);return(0,l.jsx)(I.Z,(0,T.Z)((0,T.Z)({valueEnum:(0,ee.h)(x),request:J,params:V,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,T.Z)({options:B,mode:G,showSearch:W,getPopupContainer:ie.getPopupContainer},H),ref:b,proFieldProps:D},Y),{},{children:N}))},S=M.forwardRef(function(C,g){var b=C.fieldProps,H=C.children,N=C.params,V=C.proFieldProps,D=C.mode,G=C.valueEnum,x=C.request,J=C.options,W=(0,y.Z)(C,u),B=(0,T.Z)({options:J,mode:D||"multiple",labelInValue:!0,showSearch:!0,suffixIcon:null,autoClearSearchValue:!0,optionLabelProp:"label"},b),Y=(0,M.useContext)(re.Z);return(0,l.jsx)(I.Z,(0,T.Z)((0,T.Z)({valueEnum:(0,ee.h)(G),request:x,params:N,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,T.Z)({getPopupContainer:Y.getPopupContainer},B),ref:g,proFieldProps:V},W),{},{children:H}))}),z=M.forwardRef(j),k=S,E=z;E.SearchSelect=k,E.displayName="ProFormComponent";var R=E,F=t(5966),w=t(94272),v=t(28248),f=t(2453),me=t(68997),$=t(83622),ce=t(86738),ve=t(27484),ne=t.n(ve),fe=function(){var g=v.Z.useModal(),b=L()(g,2),H=b[0],N=b[1],V=(0,M.useState)(!1),D=L()(V,2),G=D[0],x=D[1],J=(0,M.useState)(!1),W=L()(J,2),B=W[0],Y=W[1],ie=(0,M.useState)([]),le=L()(ie,2),oe=le[0],he=le[1],Pe=(0,M.useState)(),ue=L()(Pe,2),ae=ue[0],Me=ue[1],A=(0,M.useRef)(),s=(0,w.useIntl)(),de=function(){var d=h()(o()().mark(function n(r,i){var a,p;return o()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.prev=0,m.next=3,(0,Z.editStatus)(r,i);case 3:if(p=m.sent,p.code===0){m.next=9;break}if(p.code!=-2){m.next=8;break}return f.ZP.error(p.msg),m.abrupt("return",!1);case 8:throw p.msg;case 9:return f.ZP.success(s.formatMessage({id:"pages.vipList.update.success"})),(a=A.current)===null||a===void 0||a.reload(),m.abrupt("return",!0);case 14:return m.prev=14,m.t0=m.catch(0),f.ZP.error(s.formatMessage({id:"pages.vipList.update.error"})),m.abrupt("return",!1);case 18:case"end":return m.stop()}},n,null,[[0,14]])}));return function(r,i){return d.apply(this,arguments)}}(),Ze=function(){var d=h()(o()().mark(function n(r){var i,a;return o()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,Z.deleteAdmin)(r);case 3:if(a=e.sent,a.code===0){e.next=9;break}if(a.code!=-2){e.next=8;break}return f.ZP.error(a.msg),e.abrupt("return",!1);case 8:throw a.msg;case 9:return f.ZP.success(s.formatMessage({id:"pages.vipList.update.success"})),(i=A.current)===null||i===void 0||i.reload(),e.abrupt("return",!0);case 14:return e.prev=14,e.t0=e.catch(0),f.ZP.error(s.formatMessage({id:"pages.vipList.update.error"})),e.abrupt("return",!1);case 18:case"end":return e.stop()}},n,null,[[0,14]])}));return function(r){return d.apply(this,arguments)}}(),Ce=function(){var d=h()(o()().mark(function n(r){var i,a;return o()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,Z.resetPassword)(r);case 3:if(a=e.sent,a.code===0){e.next=9;break}if(a.code!=-2){e.next=8;break}return f.ZP.error(a.msg),e.abrupt("return",!1);case 8:throw a.msg;case 9:return H.success({title:s.formatMessage({id:"pages.AdminList.resetPassword.success"}),content:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{children:s.formatMessage({id:"pages.AdminList.resetPassword.new"})+a.data}),(0,l.jsx)("div",{children:s.formatMessage({id:"pages.AdminList.resetPassword.tips"})})]})}),(i=A.current)===null||i===void 0||i.reload(),e.abrupt("return",!0);case 14:return e.prev=14,e.t0=e.catch(0),f.ZP.error(s.formatMessage({id:"pages.vipList.update.error"})),e.abrupt("return",!1);case 18:case"end":return e.stop()}},n,null,[[0,14]])}));return function(r){return d.apply(this,arguments)}}(),Se=function(){var d=h()(o()().mark(function n(r){var i,a;return o()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,Z.addAdmin)(r.role,r.username,r.password);case 3:if(a=e.sent,a.code===0){e.next=9;break}if(a.code!=-2){e.next=8;break}return f.ZP.error(a.msg),e.abrupt("return",!1);case 8:throw a.msg;case 9:return f.ZP.success(s.formatMessage({id:"pages.vipList.update.success"})),(i=A.current)===null||i===void 0||i.reload(),e.abrupt("return",!0);case 14:return e.prev=14,e.t0=e.catch(0),f.ZP.error(s.formatMessage({id:"pages.vipList.update.error"})),e.abrupt("return",!1);case 18:case"end":return e.stop()}},n,null,[[0,14]])}));return function(r){return d.apply(this,arguments)}}(),je=function(){var d=h()(o()().mark(function n(r){var i,a;return o()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,Z.editAdminRole)(r.uid,r.role);case 3:if(a=e.sent,a.code===0){e.next=9;break}if(a.code!=-2){e.next=8;break}return f.ZP.error(a.msg),e.abrupt("return",!1);case 8:throw a.msg;case 9:return f.ZP.success(s.formatMessage({id:"pages.vipList.update.success"})),(i=A.current)===null||i===void 0||i.reload(),e.abrupt("return",!0);case 14:return e.prev=14,e.t0=e.catch(0),f.ZP.error(s.formatMessage({id:"pages.vipList.update.error"})),e.abrupt("return",!1);case 18:case"end":return e.stop()}},n,null,[[0,14]])}));return function(r){return d.apply(this,arguments)}}(),Re=[{title:"ID",dataIndex:"id",formItemProps:{normalize:function(n){return n==null?void 0:n.trim()}}},{title:s.formatMessage({id:"createTime"}),dataIndex:"createTime",hideInSearch:!0,render:function(n,r){return(0,l.jsx)(l.Fragment,{children:ne()(r.createTime).format("YYYY-MM-DD HH:mm:ss")})}},{title:s.formatMessage({id:"updateTime"}),dataIndex:"updateTime",hideInSearch:!0,render:function(n,r){return(0,l.jsx)(l.Fragment,{children:ne()(r.updateTime).format("YYYY-MM-DD HH:mm:ss")})}},{title:s.formatMessage({id:"status"}),dataIndex:"status",valueEnum:{normal:{text:s.formatMessage({id:"normal"}),color:"green"},disabled:{text:s.formatMessage({id:"disabled"}),color:"red"}}},{title:s.formatMessage({id:"role"}),dataIndex:"role",request:function(){var d=h()(o()().mark(function r(){var i;return o()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,(0,Z.getRolePageList)({page:1,pageSize:100});case 2:return i=p.sent,p.abrupt("return",i.data.list.map(function(e){return{label:s.formatMessage({id:e.role}),value:e.role}}));case 4:case"end":return p.stop()}},r)}));function n(){return d.apply(this,arguments)}return n}()},{title:s.formatMessage({id:"username"}),dataIndex:"username",formItemProps:{normalize:function(n){return n==null?void 0:n.trim()}}},{title:s.formatMessage({id:"avatar"}),dataIndex:"avatar",hideInSearch:!0,render:function(n,r){return(0,l.jsx)(me.Z,{size:"small",src:(0,l.jsx)("img",{src:r.avatar,alt:"avatar"})})}},{title:s.formatMessage({id:"lastLoginTime"}),dataIndex:"lastLoginTs",hideInSearch:!0,render:function(n,r){return(0,l.jsx)(l.Fragment,{children:ne().unix(r.lastLoginTs).format("YYYY-MM-DD HH:mm:ss")})}},{title:s.formatMessage({id:"pages.vipList.options"}),dataIndex:"option",valueType:"option",hideInDescriptions:!0,render:function(n,r){var i=[];return r.status=="normal"?i.push((0,l.jsx)($.ZP,{type:"link",onClick:function(){de(r.id,"disabled")},children:s.formatMessage({id:"disable"})})):i.push((0,l.jsx)($.ZP,{type:"link",onClick:function(){de(r.id,"normal")},children:s.formatMessage({id:"enable"})})),i.push((0,l.jsx)($.ZP,{type:"link",onClick:function(){Ce(r.id)},children:s.formatMessage({id:"resetPassword"})})),r.username!=="ave_dev"&&i.push((0,l.jsx)(ce.Z,{title:s.formatMessage({id:"pages.deleteAdmin"}),description:s.formatMessage({id:"pages.deleteAdmin.comfirm"},{username:r.username}),onConfirm:h()(o()().mark(function a(){return o()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ze(r.id);case 2:case"end":return e.stop()}},a)})),children:(0,l.jsxs)($.ZP,{style:{marginRight:10},type:"link",children:[s.formatMessage({id:"delete"})," "]})}),(0,l.jsx)($.ZP,{type:"link",onClick:function(){Me(r),Y(!0)},children:s.formatMessage({id:"editRole"})})),i}}],Te=function(){var d=h()(o()().mark(function n(){var r,i,a;return o()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("getRoleListMethod"),e.next=3,(0,Z.getRolePageList)({page:1,pageSize:100});case 3:i=e.sent,(r=i.data)!==null&&r!==void 0&&r.list&&he(((a=i.data)===null||a===void 0?void 0:a.list.map(function(m){return{value:m.role,label:s.formatMessage({id:m.role})}}))||[]);case 5:case"end":return e.stop()}},n)}));return function(){return d.apply(this,arguments)}}();return(0,M.useEffect)(function(){Te()},[]),(0,l.jsxs)(U._z,{children:[(0,l.jsx)(P.Z,{actionRef:A,toolBarRender:function(){return[(0,l.jsxs)($.ZP,{type:"primary",onClick:function(){x(!0)},children:[(0,l.jsx)(te.Z,{}),s.formatMessage({id:"new"})]},"primary")]},rowKey:"id",search:{labelWidth:120},request:function(){var d=h()(o()().mark(function n(r,i){var a,p,e,m,O;return o()().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return console.log(i),r.page=r==null?void 0:r.current,delete r.current,K.next=5,(0,Z.getAdminList)(r,i);case 5:return O=K.sent,console.log({data:(a=O.data)===null||a===void 0?void 0:a.list,success:O.code==0,total:(p=O.data)===null||p===void 0?void 0:p.total}),K.abrupt("return",{data:(e=O.data)===null||e===void 0?void 0:e.list,success:O.code==0,total:(m=O.data)===null||m===void 0?void 0:m.total});case 8:case"end":return K.stop()}},n)}));return function(n,r){return d.apply(this,arguments)}}(),columns:Re}),(0,l.jsxs)(_.Y,{title:s.formatMessage({id:"pages.AdminList.newAdmin"}),open:G,onFinish:Se,onOpenChange:x,children:[(0,l.jsx)(R,{name:"role",label:s.formatMessage({id:"role"}),options:oe}),(0,l.jsx)(F.Z,{name:"username",fieldProps:{maxLength:24},label:s.formatMessage({id:"username"}),rules:[{required:!0,message:"Please enter username!"},{min:5,message:"length min 5"}]}),(0,l.jsx)(F.Z.Password,{name:"password",fieldProps:{maxLength:24},label:s.formatMessage({id:"password"}),rules:[{required:!0,message:"Please enter new password!"},{min:6,message:s.formatMessage({id:"pages.Accout.Setting.password.description"})}]})]}),ae&&B&&(0,l.jsxs)(_.Y,{title:s.formatMessage({id:"editRole"}),open:B,onFinish:function(){var d=h()(o()().mark(function n(r){var i,a;return o()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,Z.editAdminRole)(ae.id,r.role);case 3:return a=e.sent,f.ZP.success(s.formatMessage({id:"pages.vipList.update.success"})),(i=A.current)===null||i===void 0||i.reload(),e.abrupt("return",!0);case 9:return e.prev=9,e.t0=e.catch(0),f.ZP.error(s.formatMessage({id:"pages.vipList.update.error"})),e.abrupt("return",!1);case 13:case"end":return e.stop()}},n,null,[[0,9]])}));return function(n){return d.apply(this,arguments)}}(),onOpenChange:Y,children:[(0,l.jsx)(F.Z,{name:"id",label:"id",disabled:!0,initialValue:ae.id}),(0,l.jsx)(R,{name:"role",label:s.formatMessage({id:"role"}),options:oe,initialValue:ae.role})]}),N]})},ge=fe}}]);
