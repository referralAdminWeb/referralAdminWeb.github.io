"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[362],{5966:function(pe,Q,t){var X=t(97685),d=t(1413),q=t(91),M=t(21770),se=t(53025),L=t(55241),C=t(97435),te=t(67294),U=t(59348),h=t(85893),_=["fieldProps","proFieldProps"],R=["fieldProps","proFieldProps"],y="text",ee=function(m){var l=m.fieldProps,j=m.proFieldProps,S=(0,q.Z)(m,_);return(0,h.jsx)(U.Z,(0,d.Z)({valueType:y,fieldProps:l,filedConfig:{valueType:y},proFieldProps:j},S))},P=function(m){var l=(0,M.Z)(m.open||!1,{value:m.open,onChange:m.onOpenChange}),j=(0,X.Z)(l,2),S=j[0],z=j[1];return(0,h.jsx)(se.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function(E){var T,F=E.getFieldValue(m.name||[]);return(0,h.jsx)(L.Z,(0,d.Z)((0,d.Z)({getPopupContainer:function(c){return c&&c.parentNode?c.parentNode:c},onOpenChange:function(c){return z(c)},content:(0,h.jsxs)("div",{style:{padding:"4px 0"},children:[(T=m.statusRender)===null||T===void 0?void 0:T.call(m,F),m.strengthText?(0,h.jsx)("div",{style:{marginTop:10},children:(0,h.jsx)("span",{children:m.strengthText})}):null]}),overlayStyle:{width:240},placement:"rightTop"},m.popoverProps),{},{open:S,children:m.children}))}})},re=function(m){var l=m.fieldProps,j=m.proFieldProps,S=(0,q.Z)(m,R),z=(0,te.useState)(!1),H=(0,X.Z)(z,2),E=H[0],T=H[1];return l!=null&&l.statusRender&&S.name?(0,h.jsx)(P,{name:S.name,statusRender:l==null?void 0:l.statusRender,popoverProps:l==null?void 0:l.popoverProps,strengthText:l==null?void 0:l.strengthText,open:E,onOpenChange:T,children:(0,h.jsx)("div",{children:(0,h.jsx)(U.Z,(0,d.Z)({valueType:"password",fieldProps:(0,d.Z)((0,d.Z)({},(0,C.Z)(l,["statusRender","popoverProps","strengthText"])),{},{onBlur:function(A){var c;l==null||(c=l.onBlur)===null||c===void 0||c.call(l,A),T(!1)},onClick:function(A){var c;l==null||(c=l.onClick)===null||c===void 0||c.call(l,A),T(!0)}}),proFieldProps:j,filedConfig:{valueType:y}},S))})}):(0,h.jsx)(U.Z,(0,d.Z)({valueType:"password",fieldProps:l,proFieldProps:j,filedConfig:{valueType:y}},S))},I=ee;I.Password=re,I.displayName="ProFormComponent",Q.Z=I},72583:function(pe,Q,t){t.r(Q),t.d(Q,{default:function(){return ge}});var X=t(15009),d=t.n(X),q=t(99289),M=t.n(q),se=t(5574),L=t.n(se),C=t(75456),te=t(51042),U=t(90930),h=t(38521),_=t(37476),R=t(1413),y=t(91),ee=t(22270),P=t(67294),re=t(66758),I=t(59348),o=t(85893),m=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],l=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],j=function(g,$){var k=g.fieldProps,N=g.children,V=g.params,D=g.proFieldProps,G=g.mode,b=g.valueEnum,J=g.request,W=g.showSearch,B=g.options,Y=(0,y.Z)(g,m),ie=(0,P.useContext)(re.Z);return(0,o.jsx)(I.Z,(0,R.Z)((0,R.Z)({valueEnum:(0,ee.h)(b),request:J,params:V,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,R.Z)({options:B,mode:G,showSearch:W,getPopupContainer:ie.getPopupContainer},k),ref:$,proFieldProps:D},Y),{},{children:N}))},S=P.forwardRef(function(Z,g){var $=Z.fieldProps,k=Z.children,N=Z.params,V=Z.proFieldProps,D=Z.mode,G=Z.valueEnum,b=Z.request,J=Z.options,W=(0,y.Z)(Z,l),B=(0,R.Z)({options:J,mode:D||"multiple",labelInValue:!0,showSearch:!0,suffixIcon:null,autoClearSearchValue:!0,optionLabelProp:"label"},$),Y=(0,P.useContext)(re.Z);return(0,o.jsx)(I.Z,(0,R.Z)((0,R.Z)({valueEnum:(0,ee.h)(G),request:b,params:N,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,R.Z)({getPopupContainer:Y.getPopupContainer},B),ref:g,proFieldProps:V},W),{},{children:k}))}),z=P.forwardRef(j),H=S,E=z;E.SearchSelect=H,E.displayName="ProFormComponent";var T=E,F=t(5966),A=t(94272),c=t(28248),v=t(2453),me=t(7134),x=t(83622),ce=t(86738),ve=t(27484),ne=t.n(ve),fe=function(){var g=c.Z.useModal(),$=L()(g,2),k=$[0],N=$[1],V=(0,P.useState)(!1),D=L()(V,2),G=D[0],b=D[1],J=(0,P.useState)(!1),W=L()(J,2),B=W[0],Y=W[1],ie=(0,P.useState)([]),oe=L()(ie,2),le=oe[0],he=oe[1],Pe=(0,P.useState)(),de=L()(Pe,2),ae=de[0],Me=de[1],w=(0,P.useRef)(),s=(0,A.useIntl)(),ue=function(){var u=M()(d()().mark(function n(r,i){var a,f;return d()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.prev=0,p.next=3,(0,C.editStatus)(r,i);case 3:if(f=p.sent,f.code===0){p.next=9;break}if(f.code!=-2){p.next=8;break}return v.ZP.error(f.msg),p.abrupt("return",!1);case 8:throw f.msg;case 9:return v.ZP.success(s.formatMessage({id:"pages.vipList.update.success"})),(a=w.current)===null||a===void 0||a.reload(),p.abrupt("return",!0);case 14:return p.prev=14,p.t0=p.catch(0),v.ZP.error(s.formatMessage({id:"pages.vipList.update.error"})),p.abrupt("return",!1);case 18:case"end":return p.stop()}},n,null,[[0,14]])}));return function(r,i){return u.apply(this,arguments)}}(),Ze=function(){var u=M()(d()().mark(function n(r){var i,a;return d()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,C.deleteAdmin)(r);case 3:if(a=e.sent,a.code===0){e.next=9;break}if(a.code!=-2){e.next=8;break}return v.ZP.error(a.msg),e.abrupt("return",!1);case 8:throw a.msg;case 9:return v.ZP.success(s.formatMessage({id:"pages.vipList.update.success"})),(i=w.current)===null||i===void 0||i.reload(),e.abrupt("return",!0);case 14:return e.prev=14,e.t0=e.catch(0),v.ZP.error(s.formatMessage({id:"pages.vipList.update.error"})),e.abrupt("return",!1);case 18:case"end":return e.stop()}},n,null,[[0,14]])}));return function(r){return u.apply(this,arguments)}}(),Ce=function(){var u=M()(d()().mark(function n(r){var i,a;return d()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,C.resetPassword)(r);case 3:if(a=e.sent,a.code===0){e.next=9;break}if(a.code!=-2){e.next=8;break}return v.ZP.error(a.msg),e.abrupt("return",!1);case 8:throw a.msg;case 9:return k.success({title:s.formatMessage({id:"pages.AdminList.resetPassword.success"}),content:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{children:s.formatMessage({id:"pages.AdminList.resetPassword.new"})+a.data}),(0,o.jsx)("div",{children:s.formatMessage({id:"pages.AdminList.resetPassword.tips"})})]})}),(i=w.current)===null||i===void 0||i.reload(),e.abrupt("return",!0);case 14:return e.prev=14,e.t0=e.catch(0),v.ZP.error(s.formatMessage({id:"pages.vipList.update.error"})),e.abrupt("return",!1);case 18:case"end":return e.stop()}},n,null,[[0,14]])}));return function(r){return u.apply(this,arguments)}}(),Se=function(){var u=M()(d()().mark(function n(r){var i,a;return d()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,C.addAdmin)(r.role,r.username,r.password);case 3:if(a=e.sent,a.code===0){e.next=9;break}if(a.code!=-2){e.next=8;break}return v.ZP.error(a.msg),e.abrupt("return",!1);case 8:throw a.msg;case 9:return v.ZP.success(s.formatMessage({id:"pages.vipList.update.success"})),(i=w.current)===null||i===void 0||i.reload(),e.abrupt("return",!0);case 14:return e.prev=14,e.t0=e.catch(0),v.ZP.error(s.formatMessage({id:"pages.vipList.update.error"})),e.abrupt("return",!1);case 18:case"end":return e.stop()}},n,null,[[0,14]])}));return function(r){return u.apply(this,arguments)}}(),je=function(){var u=M()(d()().mark(function n(r){var i,a;return d()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,C.editAdminRole)(r.uid,r.role);case 3:if(a=e.sent,a.code===0){e.next=9;break}if(a.code!=-2){e.next=8;break}return v.ZP.error(a.msg),e.abrupt("return",!1);case 8:throw a.msg;case 9:return v.ZP.success(s.formatMessage({id:"pages.vipList.update.success"})),(i=w.current)===null||i===void 0||i.reload(),e.abrupt("return",!0);case 14:return e.prev=14,e.t0=e.catch(0),v.ZP.error(s.formatMessage({id:"pages.vipList.update.error"})),e.abrupt("return",!1);case 18:case"end":return e.stop()}},n,null,[[0,14]])}));return function(r){return u.apply(this,arguments)}}(),Te=[{title:"ID",dataIndex:"id",formItemProps:{normalize:function(n){return n==null?void 0:n.trim()}}},{title:s.formatMessage({id:"createTime"}),dataIndex:"createTime",hideInSearch:!0,render:function(n,r){return(0,o.jsx)(o.Fragment,{children:ne()(r.createTime).format("YYYY-MM-DD HH:mm:ss")})}},{title:s.formatMessage({id:"updateTime"}),dataIndex:"updateTime",hideInSearch:!0,render:function(n,r){return(0,o.jsx)(o.Fragment,{children:ne()(r.updateTime).format("YYYY-MM-DD HH:mm:ss")})}},{title:s.formatMessage({id:"status"}),dataIndex:"status",valueEnum:{normal:{text:s.formatMessage({id:"normal"}),color:"green"},disabled:{text:s.formatMessage({id:"disabled"}),color:"red"}}},{title:s.formatMessage({id:"role"}),dataIndex:"role",renderText:function(n,r){return s.formatMessage({id:r.role})}},{title:s.formatMessage({id:"username"}),dataIndex:"username",formItemProps:{normalize:function(n){return n==null?void 0:n.trim()}}},{title:s.formatMessage({id:"avatar"}),dataIndex:"avatar",hideInSearch:!0,render:function(n,r){return(0,o.jsx)(me.C,{size:"small",src:(0,o.jsx)("img",{src:r.avatar,alt:"avatar"})})}},{title:s.formatMessage({id:"lastLoginTime"}),dataIndex:"lastLoginTs",hideInSearch:!0,render:function(n,r){return(0,o.jsx)(o.Fragment,{children:ne().unix(r.lastLoginTs).format("YYYY-MM-DD HH:mm:ss")})}},{title:s.formatMessage({id:"pages.vipList.options"}),dataIndex:"option",valueType:"option",hideInDescriptions:!0,render:function(n,r){var i=[];return r.status=="normal"?i.push((0,o.jsx)(x.ZP,{type:"link",onClick:function(){ue(r.id,"disabled")},children:s.formatMessage({id:"disable"})})):i.push((0,o.jsx)(x.ZP,{type:"link",onClick:function(){ue(r.id,"normal")},children:s.formatMessage({id:"enable"})})),i.push((0,o.jsx)(x.ZP,{type:"link",onClick:function(){Ce(r.id)},children:s.formatMessage({id:"resetPassword"})})),r.username!=="ave_dev"&&i.push((0,o.jsx)(ce.Z,{title:s.formatMessage({id:"pages.deleteAdmin"}),description:s.formatMessage({id:"pages.deleteAdmin.comfirm"},{username:r.username}),onConfirm:M()(d()().mark(function a(){return d()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ze(r.id);case 2:case"end":return e.stop()}},a)})),children:(0,o.jsxs)(x.ZP,{style:{marginRight:10},type:"link",children:[s.formatMessage({id:"delete"})," "]})}),(0,o.jsx)(x.ZP,{type:"link",onClick:function(){Me(r),Y(!0)},children:s.formatMessage({id:"editRole"})})),i}}],Re=function(){var u=M()(d()().mark(function n(){var r,i,a;return d()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("getRoleListMethod"),e.next=3,(0,C.getRolePageList)({page:1,pageSize:100});case 3:i=e.sent,(r=i.data)!==null&&r!==void 0&&r.list&&he(((a=i.data)===null||a===void 0?void 0:a.list.map(function(p){return{value:p.role,label:s.formatMessage({id:p.role})}}))||[]);case 5:case"end":return e.stop()}},n)}));return function(){return u.apply(this,arguments)}}();return(0,P.useEffect)(function(){Re()},[]),(0,o.jsxs)(U._z,{children:[(0,o.jsx)(h.Z,{actionRef:w,toolBarRender:function(){return[(0,o.jsxs)(x.ZP,{type:"primary",onClick:function(){b(!0)},children:[(0,o.jsx)(te.Z,{}),s.formatMessage({id:"new"})]},"primary")]},rowKey:"id",search:{labelWidth:120},request:function(){var u=M()(d()().mark(function n(r,i){var a,f,e,p,O;return d()().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return console.log(i),r.page=r==null?void 0:r.current,delete r.current,K.next=5,(0,C.getAdminList)(r,i);case 5:return O=K.sent,console.log({data:(a=O.data)===null||a===void 0?void 0:a.list,success:O.code==0,total:(f=O.data)===null||f===void 0?void 0:f.total}),K.abrupt("return",{data:(e=O.data)===null||e===void 0?void 0:e.list,success:O.code==0,total:(p=O.data)===null||p===void 0?void 0:p.total});case 8:case"end":return K.stop()}},n)}));return function(n,r){return u.apply(this,arguments)}}(),columns:Te}),(0,o.jsxs)(_.Y,{title:s.formatMessage({id:"pages.AdminList.newAdmin"}),open:G,onFinish:Se,onOpenChange:b,children:[(0,o.jsx)(T,{name:"role",label:s.formatMessage({id:"role"}),options:le}),(0,o.jsx)(F.Z,{name:"username",fieldProps:{maxLength:24},label:s.formatMessage({id:"username"}),rules:[{required:!0,message:"Please enter username!"},{min:5,message:"length min 5"}]}),(0,o.jsx)(F.Z.Password,{name:"password",fieldProps:{maxLength:24},label:s.formatMessage({id:"password"}),rules:[{required:!0,message:"Please enter new password!"},{min:6,message:s.formatMessage({id:"pages.Accout.Setting.password.description"})}]})]}),ae&&B&&(0,o.jsxs)(_.Y,{title:s.formatMessage({id:"editRole"}),open:B,onFinish:function(){var u=M()(d()().mark(function n(r){var i,a;return d()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,C.editAdminRole)(ae.id,r.role);case 3:return a=e.sent,v.ZP.success(s.formatMessage({id:"pages.vipList.update.success"})),(i=w.current)===null||i===void 0||i.reload(),e.abrupt("return",!0);case 9:return e.prev=9,e.t0=e.catch(0),v.ZP.error(s.formatMessage({id:"pages.vipList.update.error"})),e.abrupt("return",!1);case 13:case"end":return e.stop()}},n,null,[[0,9]])}));return function(n){return u.apply(this,arguments)}}(),onOpenChange:Y,children:[(0,o.jsx)(F.Z,{name:"id",label:"id",disabled:!0,initialValue:ae.id}),(0,o.jsx)(T,{name:"role",label:s.formatMessage({id:"role"}),options:le,initialValue:ae.role})]}),N]})},ge=fe}}]);
